<div class="max-w-3xl mx-auto py-6 px-4">
  <h1 class="text-2xl font-bold mb-4">Nowa wiadomość</h1>

  <div *ngIf="error" class="p-3 mb-4 bg-red-50 border border-red-200 text-red-700 rounded">{{ error }}</div>
  <div *ngIf="success" class="p-3 mb-4 bg-green-50 border border-green-200 text-green-700 rounded">{{ success }}</div>

  <form (ngSubmit)="submit()" class="space-y-4">
    <div>
      <label class="block text-sm font-medium mb-1">Odbiorca (ID)</label>
      <input type="number" [(ngModel)]="form.recipientId" name="recipientId"
             class="w-full border rounded px-3 py-2" placeholder="np. 1001" />
    </div>

    <div>
      <label class="block text-sm font-medium mb-1">Kategoria</label>
      <select [(ngModel)]="form.category" name="category" class="w-full border rounded px-3 py-2">
        <option value="">— wybierz —</option>
        <option *ngFor="let c of categories" [value]="c">{{ c }}</option>
      </select>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <div>
        <label class="block text-sm font-medium mb-1">Priorytet</label>
        <select [(ngModel)]="form.priority" name="priority" class="w-full border rounded px-3 py-2">
          <option value="LOW">Niski</option>
          <option value="NORMAL">Normalny</option>
          <option value="HIGH">Wysoki</option>
        </select>
      </div>
      <div>
        <label class="block text-sm font-medium mb-1">Temat</label>
        <input type="text" [(ngModel)]="form.subject" name="subject" class="w-full border rounded px-3 py-2" />
      </div>
    </div>

    <div>
      <label class="block text-sm font-medium mb-1">Treść</label>
      <textarea [(ngModel)]="form.content" name="content" rows="8" class="w-full border rounded px-3 py-2" placeholder="Wpisz treść wiadomości..."></textarea>
    </div>

    <div>
      <label class="block text-sm font-medium mb-1">Załączniki</label>
      <input type="file" (change)="onFileSelected($event)" multiple />
      <ul class="mt-2 text-sm text-gray-600 list-disc pl-5" *ngIf="attachments.length">
        <li *ngFor="let f of attachments; let i = index" class="flex items-center justify-between">
          <span>{{ f.name }}</span>
          <button type="button" (click)="removeAttachment(i)" class="text-red-600 hover:underline">Usuń</button>
        </li>
      </ul>
    </div>

    <div class="flex gap-2 justify-end">
      <button type="button" (click)="cancel()" class="px-4 py-2 border rounded">Anuluj</button>
      <button type="submit" [disabled]="loading" class="px-4 py-2 bg-blue-600 text-white rounded">
        {{ loading ? 'Wysyłanie...' : 'Wyślij' }}
      </button>
    </div>
  </form>
</div>
