<div class="max-w-4xl mx-auto py-6 px-4">
  <h1 class="text-2xl font-bold mb-4">Wiadomość masowa</h1>

  <div *ngIf="error" class="p-3 mb-4 bg-red-50 border border-red-200 text-red-700 rounded">{{ error }}</div>
  <div *ngIf="success" class="p-3 mb-4 bg-green-50 border border-green-200 text-green-700 rounded">{{ success }}</div>

  <form (ngSubmit)="submit()" class="space-y-4">
    <div>
      <label class="block text-sm font-medium mb-1">Kategoria</label>
      <select [(ngModel)]="form.category" name="category" class="w-full border rounded px-3 py-2">
        <option value="">— wybierz —</option>
        <option *ngFor="let c of categories" [value]="c">{{ c }}</option>
      </select>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <div>
        <label class="block text-sm font-medium mb-1">Priorytet</label>
        <select [(ngModel)]="form.priority" name="priority" class="w-full border rounded px-3 py-2">
          <option value="LOW">Niski</option>
          <option value="NORMAL">Normalny</option>
          <option value="HIGH">Wysoki</option>
        </select>
      </div>
      <div>
        <label class="block text-sm font-medium mb-1">Temat</label>
        <input type="text" [(ngModel)]="form.subject" name="subject" class="w-full border rounded px-3 py-2" />
      </div>
    </div>

    <div>
      <label class="block text-sm font-medium mb-1">Treść</label>
      <textarea [(ngModel)]="form.content" name="content" rows="10" class="w-full border rounded px-3 py-2" placeholder="Wpisz treść wiadomości..."></textarea>
    </div>

    <div>
      <label class="block text-sm font-medium mb-2">Grupy odbiorców</label>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
        <label *ngFor="let g of contactGroups" class="flex items-start gap-2 p-3 border rounded">
          <input type="checkbox" (change)="toggleGroup(g.id, $event.target.checked)" />
          <div>
            <div class="font-medium">{{ g.name }} <span class="text-xs text-gray-500">({{ g.memberCount }})</span></div>
            <div class="text-sm text-gray-600">{{ g.description }}</div>
          </div>
        </label>
      </div>
    </div>

    <div>
      <label class="block text-sm font-medium mb-1">Załączniki</label>
      <input type="file" (change)="onFilesSelected($event)" multiple />
    </div>

    <div class="flex gap-2 justify-end">
      <button type="button" (click)="cancel()" class="px-4 py-2 border rounded">Anuluj</button>
      <button type="submit" [disabled]="loading" class="px-4 py-2 bg-blue-600 text-white rounded">
        {{ loading ? 'Wysyłanie...' : 'Wyślij' }}
      </button>
    </div>
  </form>
</div>
